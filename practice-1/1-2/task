#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>

int main() {
    pid_t pid1, pid2;

    // Создаем первого дочернего процесса
    pid1 = fork();
    if (pid1 < 0) {
        perror("Ошибка при создании первого дочернего процесса");
        exit(EXIT_FAILURE);
    }

    if (pid1 == 0) {
        // Первый дочерний процесс выполняет ps aux
        printf("Первый дочерний процесс (PID: %d) выполняет ps aux\n", getpid());
        execlp("ps", "ps", "aux", NULL);
        // Если exec вернет, значит произошла ошибка
        perror("Ошибка при выполнении ps aux");
        exit(EXIT_FAILURE);
    }

    // Создаем второго дочернего процесса
    pid2 = fork();
    if (pid2 < 0) {
        perror("Ошибка при создании второго дочернего процесса");
        exit(EXIT_FAILURE);
    }

    if (pid2 == 0) {
        // Второй дочерний процесс выполняет date
        printf("Второй дочерний процесс (PID: %d) выполняет date\n", getpid());
        execlp("date", "date", NULL);
        // Если exec вернет, значит произошла ошибка
        perror("Ошибка при выполнении date");
        exit(EXIT_FAILURE);
    }

    // Родительский процесс ожидает завершения обоих дочерних процессов
    printf("Родительский процесс (PID: %d) ждет завершения дочерних процессов...\n", getpid());
    
    waitpid(pid1, NULL, 0); // Ожидание первого дочернего процесса
    waitpid(pid2, NULL, 0); // Ожидание второго дочернего процесса

    printf("Оба дочерних процесса завершены. Родительский процесс завершает работу.\n");

    return 0;
}
